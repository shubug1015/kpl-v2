{"ast":null,"code":"var _store$getState,\n    _jsxFileName = \"/Users/Donghyun/Desktop/KPL_V2/v2_front/src/Routes/LogIn.js\";\n\nimport React, { useState, useEffect } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport styled from 'styled-components';\nimport { usersApi } from 'api';\nimport store, { logIn } from 'store';\nimport KakaoLogIn from 'Components/KakaoLogIn';\nimport NaverLogIn from 'Components/NaverLogIn';\nconst Container = styled.div`\n  display: flex;\n  justify-content: center;\n`;\nconst LogInBox = styled.div`\n  border: ${props => props.theme.mainBorder};\n  border-radius: 4px;\n  margin: 50px;\n  background-color: ${props => props.theme.whiteColor};\n  width: 400px;\n  height: 500px;\n`;\nconst LogInForm = styled.form``;\nconst Box = styled.div`\n  display: flex;\n  justify-content: center;\n  padding-top: 15px;\n  font-size: 12px;\n  :last-child {\n    margin-top: 20px;\n    &:hover {\n      text-decoration: none;\n      color: black;\n      opacity: 0.7;\n    }\n  }\n`;\nconst Title = styled.span`\n  font-size: 20px;\n`;\nconst IdInputBox = styled.input`\n  border: ${props => props.theme.mainBorder};\n  border-radius: 4px;\n  padding-left: 10px;\n  width: 250px;\n  height: 40px;\n  outline: none;\n`;\nconst AlertText = styled.div`\n  display: flex;\n  justify-content: center;\n  height: 15px;\n  color: red;\n  font-size: 11px;\n  margin-top: 15px;\n`;\nconst SaveLogged = styled.div`\n  display: flex;\n  align-items: center;\n`;\nconst SaveLoggedCheck = styled.input`\n  margin-right: 10px;\n`;\nconst SubmitBtn = styled.input`\n  border: none;\n  border-radius: 4px;\n  background-color: ${props => props.theme.pinkColor};\n  margin-bottom: 20px;\n  width: 250px;\n  height: 40px;\n  outline: none;\n`;\nconst SnsLogIn = styled.div`\n  border-top: ${props => props.theme.mainBorder};\n  padding-top: 10px;\n`;\nconst ToSignUp = styled.div``;\nconst SLink = styled(Link)`\n  &:hover {\n    text-decoration: none;\n    color: black;\n    opacity: 0.7;\n  }\n`;\nconst Logged = (_store$getState = store.getState()) === null || _store$getState === void 0 ? void 0 : _store$getState.user.logged;\n\nconst LogIn = ({\n  redux_saveLogInfo\n}) => {\n  const [id, setId] = useState('');\n  const [pw, setPw] = useState('');\n  const [logged, setLogged] = useState(Logged === true ? true : false);\n  const [token, setToken] = useState('');\n  const [user_pk, setUserPk] = useState('');\n  const [localLogged, setLocalLogged] = useState(false);\n\n  const saveLocal = () => {\n    setLocalLogged(!localLogged);\n  };\n\n  const LOGIN_INFO = 'LogInInfo';\n\n  function handleId(event) {\n    const {\n      target: {\n        value\n      }\n    } = event;\n    setId(value);\n  }\n\n  function handlePw(event) {\n    const {\n      target: {\n        value\n      }\n    } = event;\n    setPw(value);\n  }\n\n  const history = useHistory();\n\n  async function handleSubmit(event) {\n    event.preventDefault();\n\n    try {\n      const {\n        data: {\n          token\n        },\n        data: {\n          user_pk\n        }\n      } = await usersApi.login(id, pw);\n      setToken(token); //state\n\n      setUserPk(user_pk);\n      setLogged(true); //state\n    } catch {\n      setLogged(false);\n    }\n  }\n\n  useEffect(() => {\n    console.log('1');\n\n    if (logged) {\n      console.log('2');\n      redux_saveLogInfo({\n        token,\n        user_pk,\n        logged\n      }); //redux\n    }\n\n    return () => {\n      console.log('unmount');\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [logged]);\n  store.subscribe(() => {\n    var _store$getState2, _store$getState3, _store$getState4;\n\n    console.log('subscribe');\n\n    if (((_store$getState2 = store.getState()) === null || _store$getState2 === void 0 ? void 0 : _store$getState2.user.logged) && ((_store$getState3 = store.getState()) === null || _store$getState3 === void 0 ? void 0 : _store$getState3.location[((_store$getState4 = store.getState()) === null || _store$getState4 === void 0 ? void 0 : _store$getState4.location.length) - 1].location) === '/login') {\n      if (localLogged === true) {\n        localStorage.setItem(LOGIN_INFO, JSON.stringify(store.getState().user));\n      } else {\n        sessionStorage.setItem(LOGIN_INFO, JSON.stringify(store.getState().user));\n      } // console.log(store);\n\n\n      console.log('go back');\n      history.goBack();\n    }\n  }); // const kakaoLogin = async () => {\n  //   console.log('kakao');\n  //   const client_id = '371acbd5580e03f53c7b2714408de194';\n  //   const redirect_uri = 'http://127.0.0.1:8000/users/login/kakao/callback';\n  //   try {\n  //     await usersApi.kakaoLogin(client_id, redirect_uri);\n  //     // setLogged(true);\n  //     // setToken(token);\n  //     // redux_saveLogInfo({ token, logged: true });\n  //     // window.location.reload(true);\n  //   } catch {\n  //     console.log('fuck');\n  //     setLogged(false);\n  //   }\n  // };\n\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(LogInBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(LogInForm, {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 13\n    }\n  }, \"Log In\")), /*#__PURE__*/React.createElement(Box, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IdInputBox, {\n    onChange: handleId,\n    type: \"text\",\n    placeholder: \"\\uC544\\uC774\\uB514\\uB97C \\uC785\\uB825\\uD558\\uC138\\uC694.\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Box, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IdInputBox, {\n    onChange: handlePw,\n    type: \"password\",\n    placeholder: \"\\uBE44\\uBC00\\uBC88\\uD638\\uB97C \\uC785\\uB825\\uD558\\uC138\\uC694.\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 13\n    }\n  })), logged === true || logged === null ? '' : /*#__PURE__*/React.createElement(AlertText, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 13\n    }\n  }, \"* \\uC544\\uC774\\uB514 \\uB610\\uB294 \\uBE44\\uBC00\\uBC88\\uD638\\uB97C \\uD655\\uC778\\uD574 \\uC8FC\\uC138\\uC694\"), /*#__PURE__*/React.createElement(Box, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(SaveLogged, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(SaveLoggedCheck, {\n    type: \"checkbox\",\n    onClick: saveLocal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 15\n    }\n  }), \"\\uB85C\\uADF8\\uC778\\uC0C1\\uD0DC \\uC720\\uC9C0\\uD558\\uAE30\")), /*#__PURE__*/React.createElement(Box, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(SubmitBtn, {\n    type: \"submit\",\n    value: \"\\uB85C\\uADF8\\uC778\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(SnsLogIn, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(KakaoLogIn, {\n    history: history,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Box, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(NaverLogIn, {\n    history: history,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Box, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(SLink, {\n    to: \"/signup\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ToSignUp, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 15\n    }\n  }, \"\\uD68C\\uC6D0\\uAC00\\uC785 >\"))))));\n};\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n  return {\n    redux_saveLogInfo: data => dispatch(logIn(data))\n  };\n};\n\nexport default connect(null, mapDispatchToProps)(LogIn);","map":{"version":3,"sources":["/Users/Donghyun/Desktop/KPL_V2/v2_front/src/Routes/LogIn.js"],"names":["React","useState","useEffect","Link","useHistory","connect","styled","usersApi","store","logIn","KakaoLogIn","NaverLogIn","Container","div","LogInBox","props","theme","mainBorder","whiteColor","LogInForm","form","Box","Title","span","IdInputBox","input","AlertText","SaveLogged","SaveLoggedCheck","SubmitBtn","pinkColor","SnsLogIn","ToSignUp","SLink","Logged","getState","user","logged","LogIn","redux_saveLogInfo","id","setId","pw","setPw","setLogged","token","setToken","user_pk","setUserPk","localLogged","setLocalLogged","saveLocal","LOGIN_INFO","handleId","event","target","value","handlePw","history","handleSubmit","preventDefault","data","login","console","log","subscribe","location","length","localStorage","setItem","JSON","stringify","sessionStorage","goBack","mapDispatchToProps","dispatch","ownProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport styled from 'styled-components';\nimport { usersApi } from 'api';\nimport store, { logIn } from 'store';\nimport KakaoLogIn from 'Components/KakaoLogIn';\nimport NaverLogIn from 'Components/NaverLogIn';\n\nconst Container = styled.div`\n  display: flex;\n  justify-content: center;\n`;\n\nconst LogInBox = styled.div`\n  border: ${(props) => props.theme.mainBorder};\n  border-radius: 4px;\n  margin: 50px;\n  background-color: ${(props) => props.theme.whiteColor};\n  width: 400px;\n  height: 500px;\n`;\n\nconst LogInForm = styled.form``;\n\nconst Box = styled.div`\n  display: flex;\n  justify-content: center;\n  padding-top: 15px;\n  font-size: 12px;\n  :last-child {\n    margin-top: 20px;\n    &:hover {\n      text-decoration: none;\n      color: black;\n      opacity: 0.7;\n    }\n  }\n`;\n\nconst Title = styled.span`\n  font-size: 20px;\n`;\n\nconst IdInputBox = styled.input`\n  border: ${(props) => props.theme.mainBorder};\n  border-radius: 4px;\n  padding-left: 10px;\n  width: 250px;\n  height: 40px;\n  outline: none;\n`;\n\nconst AlertText = styled.div`\n  display: flex;\n  justify-content: center;\n  height: 15px;\n  color: red;\n  font-size: 11px;\n  margin-top: 15px;\n`;\n\nconst SaveLogged = styled.div`\n  display: flex;\n  align-items: center;\n`;\n\nconst SaveLoggedCheck = styled.input`\n  margin-right: 10px;\n`;\n\nconst SubmitBtn = styled.input`\n  border: none;\n  border-radius: 4px;\n  background-color: ${(props) => props.theme.pinkColor};\n  margin-bottom: 20px;\n  width: 250px;\n  height: 40px;\n  outline: none;\n`;\n\nconst SnsLogIn = styled.div`\n  border-top: ${(props) => props.theme.mainBorder};\n  padding-top: 10px;\n`;\n\nconst ToSignUp = styled.div``;\n\nconst SLink = styled(Link)`\n  &:hover {\n    text-decoration: none;\n    color: black;\n    opacity: 0.7;\n  }\n`;\n\nconst Logged = store.getState()?.user.logged;\n\nconst LogIn = ({ redux_saveLogInfo }) => {\n  const [id, setId] = useState('');\n  const [pw, setPw] = useState('');\n  const [logged, setLogged] = useState(Logged === true ? true : false);\n  const [token, setToken] = useState('');\n  const [user_pk, setUserPk] = useState('');\n\n  const [localLogged, setLocalLogged] = useState(false);\n\n  const saveLocal = () => {\n    setLocalLogged(!localLogged);\n  };\n\n  const LOGIN_INFO = 'LogInInfo';\n\n  function handleId(event) {\n    const {\n      target: { value },\n    } = event;\n    setId(value);\n  }\n\n  function handlePw(event) {\n    const {\n      target: { value },\n    } = event;\n    setPw(value);\n  }\n\n  const history = useHistory();\n\n  async function handleSubmit(event) {\n    event.preventDefault();\n    try {\n      const {\n        data: { token },\n        data: { user_pk },\n      } = await usersApi.login(id, pw);\n      setToken(token); //state\n      setUserPk(user_pk);\n      setLogged(true); //state\n    } catch {\n      setLogged(false);\n    }\n  }\n\n  useEffect(() => {\n    console.log('1');\n    if (logged) {\n      console.log('2');\n      redux_saveLogInfo({ token, user_pk, logged }); //redux\n    }\n    return () => {\n      console.log('unmount');\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [logged]);\n\n  store.subscribe(() => {\n    console.log('subscribe');\n    if (\n      store.getState()?.user.logged &&\n      store.getState()?.location[store.getState()?.location.length - 1]\n        .location === '/login'\n    ) {\n      if (localLogged === true) {\n        localStorage.setItem(LOGIN_INFO, JSON.stringify(store.getState().user));\n      } else {\n        sessionStorage.setItem(\n          LOGIN_INFO,\n          JSON.stringify(store.getState().user)\n        );\n      }\n      // console.log(store);\n      console.log('go back');\n      history.goBack();\n    }\n  });\n  // const kakaoLogin = async () => {\n  //   console.log('kakao');\n  //   const client_id = '371acbd5580e03f53c7b2714408de194';\n  //   const redirect_uri = 'http://127.0.0.1:8000/users/login/kakao/callback';\n  //   try {\n  //     await usersApi.kakaoLogin(client_id, redirect_uri);\n  //     // setLogged(true);\n  //     // setToken(token);\n  //     // redux_saveLogInfo({ token, logged: true });\n  //     // window.location.reload(true);\n  //   } catch {\n  //     console.log('fuck');\n  //     setLogged(false);\n  //   }\n  // };\n\n  return (\n    <Container>\n      <LogInBox>\n        <LogInForm onSubmit={handleSubmit}>\n          <Box>\n            <Title>Log In</Title>\n          </Box>\n          <Box>\n            <IdInputBox\n              onChange={handleId}\n              type='text'\n              placeholder='아이디를 입력하세요.'\n            />\n          </Box>\n          <Box>\n            <IdInputBox\n              onChange={handlePw}\n              type='password'\n              placeholder='비밀번호를 입력하세요.'\n            />\n          </Box>\n          {logged === true || logged === null ? (\n            ''\n          ) : (\n            <AlertText>* 아이디 또는 비밀번호를 확인해 주세요</AlertText>\n          )}\n          <Box>\n            <SaveLogged>\n              <SaveLoggedCheck type='checkbox' onClick={saveLocal} />\n              로그인상태 유지하기\n            </SaveLogged>\n          </Box>\n          <Box>\n            <SubmitBtn type='submit' value='로그인' />\n          </Box>\n        </LogInForm>\n        <SnsLogIn>\n          <Box>\n            <KakaoLogIn history={history} />\n          </Box>\n          <Box>\n            <NaverLogIn history={history} />\n          </Box>\n          <Box>\n            <SLink to='/signup'>\n              <ToSignUp>회원가입 ></ToSignUp>\n            </SLink>\n          </Box>\n        </SnsLogIn>\n      </LogInBox>\n    </Container>\n  );\n};\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n  return {\n    redux_saveLogInfo: (data) => dispatch(logIn(data)),\n  };\n};\n\nexport default connect(null, mapDispatchToProps)(LogIn);\n"]},"metadata":{},"sourceType":"module"}