{"ast":null,"code":"var _jsxFileName = \"/Users/Donghyun/Desktop/KPL_V2/v2_front/src/Routes/Detail/DetailContainer3.js\";\nimport React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport DetailPresenter from './DetailPresenter';\nimport { productsApi, usersApi } from 'api';\nimport Loader from 'Components/Loader';\nimport store from 'store';\n\nconst DetailContainer = () => {\n  const [detailData, setDetailData] = useState({\n    detail: '',\n    productImg: '',\n    favs: [],\n    baskets: [],\n    recent: [],\n    reviews: [],\n    qnas: []\n  });\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const {\n    id: productId\n  } = useParams();\n\n  const getProductData = async () => {\n    var _store$getState;\n\n    const {\n      data: detail\n    } = await productsApi.showDetail(productId);\n    const {\n      data: {\n        results: reviews\n      }\n    } = await productsApi.reviews(productId);\n    const {\n      data: {\n        results: qnas\n      }\n    } = await productsApi.qnas(productId);\n    const recent = (_store$getState = store.getState()) === null || _store$getState === void 0 ? void 0 : _store$getState.products.map(i => i.product);\n    return [detail, reviews, qnas, recent];\n  };\n\n  const getUserData = async () => {\n    const {\n      data: favsData\n    } = await usersApi.favs();\n    const {\n      data: basketData\n    } = await usersApi.basket();\n    const favs = favsData.map(item => item.product);\n    const baskets = basketData.map(item => item.product);\n    return [favs, baskets];\n  };\n\n  const getData = async () => {\n    try {\n      var _store$getState2;\n\n      const [detail, reviews, qnas, recent] = await getProductData();\n\n      if ((_store$getState2 = store.getState()) === null || _store$getState2 === void 0 ? void 0 : _store$getState2.user.logged) {\n        const [favs, baskets] = await getUserData();\n        setDetailData({\n          detail: detail,\n          favs: favs,\n          baskets: baskets,\n          recent: recent,\n          reviews: reviews,\n          qnas: qnas\n        });\n      } else {\n        setDetailData({\n          detail: detail,\n          favs: [],\n          baskets: [],\n          recent: recent,\n          reviews: reviews,\n          qnas: qnas\n        });\n      }\n    } catch {\n      setError(\"Can't find anything.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    getData(); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [productId]);\n  const {\n    detail,\n    favs,\n    baskets,\n    recent,\n    reviews,\n    qnas\n  } = detailData;\n  return loading ? /*#__PURE__*/React.createElement(Loader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 5\n    }\n  }) : /*#__PURE__*/React.createElement(DetailPresenter, {\n    detail: detail,\n    favs: favs,\n    baskets: baskets,\n    recent: recent,\n    reviews: reviews,\n    qnas: qnas,\n    error: error,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }\n  });\n};\n\nexport default DetailContainer;","map":{"version":3,"sources":["/Users/Donghyun/Desktop/KPL_V2/v2_front/src/Routes/Detail/DetailContainer3.js"],"names":["React","useState","useEffect","useParams","DetailPresenter","productsApi","usersApi","Loader","store","DetailContainer","detailData","setDetailData","detail","productImg","favs","baskets","recent","reviews","qnas","error","setError","loading","setLoading","id","productId","getProductData","data","showDetail","results","getState","products","map","i","product","getUserData","favsData","basketData","basket","item","getData","user","logged"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport DetailPresenter from './DetailPresenter';\nimport { productsApi, usersApi } from 'api';\nimport Loader from 'Components/Loader';\nimport store from 'store';\n\nconst DetailContainer = () => {\n  const [detailData, setDetailData] = useState({\n    detail: '',\n    productImg: '',\n    favs: [],\n    baskets: [],\n    recent: [],\n    reviews: [],\n    qnas: [],\n  });\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const { id: productId } = useParams();\n\n  const getProductData = async () => {\n    const { data: detail } = await productsApi.showDetail(productId);\n    const {\n      data: { results: reviews },\n    } = await productsApi.reviews(productId);\n    const {\n      data: { results: qnas },\n    } = await productsApi.qnas(productId);\n    const recent = store.getState()?.products.map((i) => i.product);\n    return [detail, reviews, qnas, recent];\n  };\n\n  const getUserData = async () => {\n    const { data: favsData } = await usersApi.favs();\n    const { data: basketData } = await usersApi.basket();\n    const favs = favsData.map((item) => item.product);\n    const baskets = basketData.map((item) => item.product);\n    return [favs, baskets];\n  };\n\n  const getData = async () => {\n    try {\n      const [detail, reviews, qnas, recent] = await getProductData();\n\n      if (store.getState()?.user.logged) {\n        const [favs, baskets] = await getUserData();\n        setDetailData({\n          detail: detail,\n          favs: favs,\n          baskets: baskets,\n          recent: recent,\n          reviews: reviews,\n          qnas: qnas,\n        });\n      } else {\n        setDetailData({\n          detail: detail,\n          favs: [],\n          baskets: [],\n          recent: recent,\n          reviews: reviews,\n          qnas: qnas,\n        });\n      }\n    } catch {\n      setError(\"Can't find anything.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    getData();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [productId]);\n\n  const { detail, favs, baskets, recent, reviews, qnas } = detailData;\n\n  return loading ? (\n    <Loader />\n  ) : (\n    <DetailPresenter\n      detail={detail}\n      favs={favs}\n      baskets={baskets}\n      recent={recent}\n      reviews={reviews}\n      qnas={qnas}\n      error={error}\n    />\n  );\n};\n\nexport default DetailContainer;\n"]},"metadata":{},"sourceType":"module"}